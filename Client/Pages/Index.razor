@page "/"
@inject HttpClient Http

<PageTitle>Index</PageTitle>

<h1>Fuck you, world!</h1>

<h3>Search YouTube Videos</h3>

<!-- Search input and button -->
<div>
    <input type="text" @bind="searchTerm" placeholder="Enter search term..." />
    <button @onclick="SearchVideos">Search</button>
</div>

<h3>Video List</h3>

<!-- Radzen Data Grid and its Title -->
<h3 style="margin-top: 50px;">Youtube Videos!</h3>
<RadzenDataGrid Style="width: 1024px; height: 600px;"
                Data="@videos" TItem="Videos" Count="@videos.Count" PageSize="25"
                AllowPaging="true" AllowSorting="true" AllowColumnResize="true" 
                AllowColumnPicking="true" ShowPagingSummary="true" AllowFiltering="true" >
    <Columns>
        <RadzenDataGridColumn TItem="Videos" Property="Title" Title="Title" />
        <RadzenDataGridColumn TItem="Videos" Property="Channel" Title="Channel" />
        <RadzenDataGridColumn TItem="Videos" Property="Published" Title="Published" />
        <RadzenDataGridColumn TItem="Videos" Property="Duration" Title="Duration" />
        <RadzenDataGridColumn TItem="Videos" Property="Url" Title="Url" />
    </Columns>
</RadzenDataGrid>


<!-- Radzen Button to fill the Data Grid code -->
@code {
    private string? searchTerm;
    private List<Videos>? videos;

    private async Task SearchVideos()
    {
        var response = await Http.GetAsync($"https://func-app-powershell001.azurewebsites.net/api/HttpTrigger3?searchterm={searchTerm}");
        if (response.IsSuccessStatusCode)
        {
            var jsonString = await response.Content.ReadAsStringAsync();
            videos = System.Text.Json.JsonSerializer.Deserialize<List<Videos>>(jsonString);
        }
    }
}